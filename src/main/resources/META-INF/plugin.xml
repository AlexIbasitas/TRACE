<!-- TRACE: Cucumber Test Failure Triage Assistant -->
<idea-plugin>
    <id>com.trace</id>
    <name>TRACE</name>
    <version>1.0.0</version>
    <vendor email="aibasitas1@gmail.com" url="https://github.com/alexibasitas">Alex Ibasitas</vendor>
    <change-notes><![CDATA[
        <h3>Version 1.0.0 - Initial Release</h3>
        <p>First release of TRACE, an AI-powered test failure analysis assistant for Cucumber tests in IntelliJ IDEA.</p>
        
        <p><b>Setup:</b></p>
        <ol>
            <li>Turn TRACE on via the ‚èª icon in the toolbar</li>
            <li>Enable "AI Analysis" checkbox (recommended)</li>
            <li>Add your API key in Settings > TRACE (recommended)</li>
        </ol>
    ]]></change-notes>
    <description><![CDATA[
        <p>TRACE is an intelligent test failure analysis assistant for Cucumber Java tests in IntelliJ IDEA.</p>
        
        <h3>Key Features:</h3>
        <ul>
            <li><b>Automatic Failure Detection</b> - Automatically captures and analyzes Cucumber test failures</li>
            <li><b>AI-Powered Analysis</b> - Get intelligent suggestions for fixing test failures using OpenAI or Google Gemini</li>
            <li><b>Context Extraction</b> - Extracts step definitions, Gherkin scenarios, and stack traces automatically</li>
            <li><b>Chat Interface</b> - Interactive chat interface for asking follow-up questions about failures</li>
            <li><b>Secure API Management</b> - Secure storage of API keys using IntelliJ's PasswordSafe</li>
        </ul>
        
        <h3>How It Works:</h3>
        <p>When a Cucumber test fails, TRACE automatically:</p>
        <ol>
            <li>Extracts the failure information and stack trace</li>
            <li>Finds the corresponding step definition and Gherkin scenario</li>
            <li>Generates an AI prompt with all relevant context</li>
            <li>Displays the analysis in an easy-to-read chat interface</li>
        </ol>
        
        <h3>Perfect For:</h3>
        <ul>
            <li>SDETs and QA Engineers working with Cucumber tests</li>
            <li>Teams using Behavior-Driven Development (BDD)</li>
            <li>Developers who want faster test failure triage</li>
        </ul>
        
        <p><b>Requirements:</b></p>
        <ul>
            <li><b>Project Setup:</b> Cucumber Java project with appropriate dependencies (cucumber-java, gherkin, etc.)</li>
            <li><b>AI Features:</b> OpenAI API key or Google Gemini API key for AI analysis features</li>
        </ul>
        <p><b>Compatibility:</b> IntelliJ IDEA 2025.2+ | <b>Version:</b> 1.0.0</p>
        
        <h3>Important:</h3>
        <ul>
            <li><b>Data Processing:</b> Local analysis of stack traces, step definitions, and scenarios (configurable)</li>
            <li><b>Network Usage:</b> AI analysis sends test failure context to configured services (OpenAI/Gemini) - optional</li>
            <li><b>Storage:</b> Includes 1.03MB embedded database with testing best practices and documentation</li>
        </ul>
        
        <p><b>License:</b> MIT License - See LICENSE file for details</p>
        <p><b>Privacy Policy:</b> <a href="https://alexibasitas.github.io/TRACE/PRIVACY.html">View our privacy policy</a></p>
        <p><b>Support:</b> <a href="https://github.com/alexibasitas/trace">GitHub Repository</a></p>
    ]]></description>

    <idea-version since-build="252" until-build="253.*"/>

    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.java</depends>

    <extensions defaultExtensionNs="com.intellij">
        <!-- Tool Window -->
        <toolWindow id="AI Assistant"
                   name="TRACE"
                   secondary="false" 
                   icon="icons/t_logo.png" 
                   anchor="right" 
                   factoryClass="com.trace.chat.ui.TriagePanelToolWindowFactory"/>
        
        <!-- Services with proper disposal configuration -->
        <projectService serviceImplementation="com.trace.ai.services.AINetworkService"/>
        <applicationService serviceImplementation="com.trace.ai.services.AIModelService"/>
        <projectService serviceImplementation="com.trace.ai.services.ChatHistoryService"/>
        <applicationService serviceImplementation="com.trace.ai.prompts.InitialPromptFailureAnalysisService"/>
        <applicationService serviceImplementation="com.trace.ai.configuration.AISettings"/>
    </extensions>

    <applicationListeners>
        <!-- Test Execution Listeners -->
        <listener class="com.trace.test.listeners.CucumberTestExecutionListener"
                  topic="com.intellij.execution.testframework.sm.runner.SMTRunnerEventsListener"/>
    </applicationListeners>

    <projectListeners>
        <!-- Project Lifecycle Listener for cleanup -->
        <listener class="com.trace.listeners.ProjectLifecycleListener"
                  topic="com.intellij.openapi.project.ProjectManagerListener"/>
    </projectListeners>

</idea-plugin> 